(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{4224:function(e,t,a){Promise.resolve().then(a.bind(a,2049))},2049:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return UserEventsPage}});var r=a(7437),n=a(2265),s=a(4033),o=a(9727),i=a(5734),c=a(4337);function UserEventsPage(){let[e,t]=(0,n.useState)(null),[a,l]=(0,n.useState)([]),[d,u]=(0,n.useState)(!0),h=(0,s.useRouter)();(0,n.useEffect)(()=>{let checkAuth=async()=>{let e=(0,o.bW)();if(!e){h.push("/");return}try{let e=await o.kv.getCurrentUser();t(e.user)}catch(e){(0,o.H6)(),h.push("/")}finally{u(!1)}};checkAuth()},[h]);let loadEvents=async()=>{try{let e=await i.d.getEvents(1,50,"active");l(e.events)}catch(e){console.error("Error loading events:",e),l([])}};return((0,n.useEffect)(()=>{let e=null;return d||(loadEvents(),(e=(0,c.ZP)("https://kretoss-task.onrender.com")).on("event:updated",e=>{l(t=>t.map(t=>t._id===e.eventId?{...t,availableSeats:e.availableSeats}:t))}),e.on("events:updated",()=>{loadEvents()})),()=>{e&&e.disconnect()}},[d]),d)?null:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Browse Events"}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Welcome, ",null==e?void 0:e.name]})]})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:0===a.length?(0,r.jsx)("div",{className:"text-center py-16",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-12 max-w-md mx-auto",children:[(0,r.jsx)("svg",{className:"mx-auto h-16 w-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No events available"}),(0,r.jsx)("p",{className:"text-gray-500 mb-6",children:"Check back later for new events to book."}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Refresh"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 border border-gray-100",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:e.primaryImage.url,alt:e.title,className:"w-full h-48 object-cover"}),(0,r.jsx)("div",{className:"absolute top-4 right-4",children:(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(e.availableSeats>0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.availableSeats>0?"Available":"Sold Out"})})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,r.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2 mb-4",children:e.description}),(0,r.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(e.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.location]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.availableSeats," / ",e.totalSeats," seats"]}),(0,r.jsxs)("div",{className:"flex items-center text-sm font-semibold text-primary-600",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"$",e.ticketPrice.toFixed(2)]})]}),(0,r.jsx)("button",{onClick:()=>h.push("/events/".concat(e._id)),className:"w-full btn-primary hover:bg-primary-700 transition-colors",disabled:e.availableSeats<=0,children:e.availableSeats>0?"View Details":"Sold Out"})]})]},e._id))})})]})}},9727:function(e,t,a){"use strict";a.d(t,{H6:function(){return removeAuthToken},bW:function(){return getAuthToken},kv:function(){return s},uB:function(){return setAuthToken}});var r=a(4771),n=a(1490);a(2265);let s={login:async(e,t)=>{let a=await r.Z.post("/auth/login",{email:e,password:t});return a.data},register:async(e,t,a,n)=>{let s=await r.Z.post("/auth/register",{name:e,email:t,password:a,role:n});return s.data},getCurrentUser:async()=>{let e=n.Z.get("token"),t=await r.Z.get("/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});return t.data}},setAuthToken=e=>{n.Z.set("token",e,{expires:7})},removeAuthToken=()=>{n.Z.remove("token")},getAuthToken=()=>n.Z.get("token")},4771:function(e,t,a){"use strict";var r=a(4829),n=a(1490),s=a(5267);let o=r.Z.create({baseURL:"https://kretoss-task.onrender.com/api",timeout:3e4,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{var t;(null===(t=e.url)||void 0===t?void 0:t.includes("health"))||(0,s.VO)();let a=n.Z.get("token");return a&&(e.headers||(e.headers={}),e.headers.Authorization||(e.headers.Authorization="Bearer ".concat(a))),e},e=>((0,s.Gx)(),Promise.reject(e))),o.interceptors.response.use(e=>((0,s.Gx)(),e),e=>{var t;return(0,s.Gx)(),(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(n.Z.remove("token"),window.location.href="/"),Promise.reject(e)}),t.Z=o},5734:function(e,t,a){"use strict";a.d(t,{d:function(){return s}});var r=a(4771),n=a(9727);let s={getEvents:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"active",n=await r.Z.get("/events",{params:{page:e,limit:t,status:a}});return n.data},getEvent:async e=>{let t=await r.Z.get("/events/".concat(e));return t.data},createEvent:async e=>{let t=(0,n.bW)(),a=new FormData;a.append("title",e.title),a.append("description",e.description),a.append("date",e.date),a.append("location",e.location),a.append("totalSeats",e.totalSeats.toString()),a.append("ticketPrice",e.ticketPrice.toString()),a.append("primaryImage",e.primaryImage),e.secondaryImages&&e.secondaryImages.forEach((e,t)=>{a.append("secondaryImages",e)});let s=await r.Z.post("/events",a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(t)}});return s.data},updateEvent:async(e,t)=>{let a=(0,n.bW)(),s=new FormData;t.title&&s.append("title",t.title),t.description&&s.append("description",t.description),t.date&&s.append("date",t.date),t.location&&s.append("location",t.location),t.totalSeats&&s.append("totalSeats",t.totalSeats.toString()),t.ticketPrice&&s.append("ticketPrice",t.ticketPrice.toString()),t.primaryImage&&s.append("primaryImage",t.primaryImage),t.secondaryImages&&t.secondaryImages.forEach(e=>{s.append("secondaryImages",e)});let o=await r.Z.put("/events/".concat(e),s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(a)}});return o.data},deleteEvent:async e=>{let t=(0,n.bW)();await r.Z.delete("/events/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},updateEventStatus:async(e,t)=>{let a=(0,n.bW)(),s=await r.Z.patch("/events/".concat(e,"/status"),{status:t},{headers:{Authorization:"Bearer ".concat(a)}});return s.data}}},5267:function(e,t,a){"use strict";a.d(t,{Gx:function(){return hideLoader},RF:function(){return isLoaderVisible},VO:function(){return showLoader},Yb:function(){return subscribeLoader}});let r=!1,n=new Set;function showLoader(){r||(r=!0,n.forEach(e=>e(!0)))}function hideLoader(){r&&(r=!1,n.forEach(e=>e(!1)))}function subscribeLoader(e){return n.add(e),()=>n.delete(e)}function isLoaderVisible(){return r}}},function(e){e.O(0,[745,337,971,864,744],function(){return e(e.s=4224)}),_N_E=e.O()}]);