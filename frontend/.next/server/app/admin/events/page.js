(()=>{var e={};e.id=206,e.ids=[206],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1212:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>m,routeModule:()=>h,tree:()=>c});var a=s(3137),r=s(4647),i=s(4183),l=s.n(i),n=s(1775),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=a.AppPageRouteModule,c=["",{children:["admin",{children:["events",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1945)),"C:\\Users\\missa\\Downloads\\kretoss technology\\frontend\\app\\admin\\events\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5891)),"C:\\Users\\missa\\Downloads\\kretoss technology\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,1918,23)),"next/dist/client/components/not-found-error"]}],m=["C:\\Users\\missa\\Downloads\\kretoss technology\\frontend\\app\\admin\\events\\page.tsx"],x="/admin/events/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new d({definition:{kind:r.x.APP_PAGE,page:"/admin/events/page",pathname:"/admin/events",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5158:(e,t,s)=>{Promise.resolve().then(s.bind(s,1559))},1559:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>AdminEventsPage});var a=s(80),r=s(9885),i=s(7114),l=s(1014),n=s(58);function EventList({events:e,loading:t,onEdit:s,onDelete:r,onStatusChange:i,currentPage:l,totalPages:n,onPageChange:o}){let formatDate=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),formatPrice=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),getStatusBadge=e=>a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",completed:"bg-gray-100 text-gray-800"}[e]}`,children:e.charAt(0).toUpperCase()+e.slice(1)});return t?a.jsx("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading events..."})]})}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No events"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new event."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"aspect-w-16 aspect-h-9",children:a.jsx("img",{src:e.primaryImage.url,alt:e.title,className:"w-full h-48 object-cover"})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2",children:e.title}),getStatusBadge(e.status)]}),a.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),formatDate(e.date)]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,a.jsxs)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.location]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.availableSeats," / ",e.totalSeats," seats"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm font-semibold text-primary-600",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),formatPrice(e.ticketPrice)]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>s(e),className:"flex-1 btn-secondary text-sm py-2",children:"Edit"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsxs)("select",{value:e.status,onChange:t=>i(e._id,t.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1",children:[a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"cancelled",children:"Cancelled"}),a.jsx("option",{value:"completed",children:"Completed"})]}),a.jsx("button",{onClick:()=>r(e._id),className:"text-red-600 hover:text-red-800 text-sm px-2 py-1",children:"Delete"})]})]})]})]},e._id))}),n>1&&(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>o(l-1),disabled:1===l,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,a.jsxs)("span",{className:"px-3 py-2 text-sm font-medium text-gray-700",children:["Page ",l," of ",n]}),a.jsx("button",{onClick:()=>o(l+1),disabled:l===n,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}function EventForm({event:e,onClose:t,onSubmit:s}){let[i,l]=(0,r.useState)({title:"",description:"",date:"",location:"",totalSeats:"",ticketPrice:""}),[o,d]=(0,r.useState)(null),[c,m]=(0,r.useState)([]),[x,u]=(0,r.useState)(""),[h,p]=(0,r.useState)([]),[g,v]=(0,r.useState)(!1),[f,y]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&(l({title:e.title,description:e.description,date:new Date(e.date).toISOString().slice(0,16),location:e.location,totalSeats:e.totalSeats.toString(),ticketPrice:e.ticketPrice.toString()}),u(e.primaryImage.url),p(e.secondaryImages.map(e=>e.url)))},[e]);let handleChange=e=>{l({...i,[e.target.name]:e.target.value})},removeSecondaryImage=e=>{let t=c.filter((t,s)=>s!==e),s=h.filter((t,s)=>s!==e);m(t),p(s)},handleSubmit=async t=>{t.preventDefault(),v(!0),y("");try{if(e){let t={title:i.title,description:i.description,date:i.date,location:i.location,totalSeats:parseInt(i.totalSeats),ticketPrice:parseFloat(i.ticketPrice)};o&&(t.primaryImage=o),c.length>0&&(t.secondaryImages=c),await n.d.updateEvent(e._id,t)}else{if(!o){y("Primary image is required"),v(!1);return}let e={title:i.title,description:i.description,date:i.date,location:i.location,totalSeats:parseInt(i.totalSeats),ticketPrice:parseFloat(i.ticketPrice),primaryImage:o,secondaryImages:c.length>0?c:void 0};await n.d.createEvent(e)}s()}catch(e){y(e.response?.data?.message||"Failed to save event")}finally{v(!1)}};return a.jsx("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Event":"Create New Event"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"p-6 space-y-6",children:[f&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:f}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"title",className:"form-label",children:"Event Title *"}),a.jsx("input",{type:"text",id:"title",name:"title",value:i.title,onChange:handleChange,className:"input-field",required:!0,placeholder:"Enter event title"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"date",className:"form-label",children:"Event Date & Time *"}),a.jsx("input",{type:"datetime-local",id:"date",name:"date",value:i.date,onChange:handleChange,className:"input-field",required:!0})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"description",className:"form-label",children:"Description *"}),a.jsx("textarea",{id:"description",name:"description",value:i.description,onChange:handleChange,className:"input-field",rows:4,required:!0,placeholder:"Describe your event..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"location",className:"form-label",children:"Location *"}),a.jsx("input",{type:"text",id:"location",name:"location",value:i.location,onChange:handleChange,className:"input-field",required:!0,placeholder:"Event location"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"totalSeats",className:"form-label",children:"Total Seats *"}),a.jsx("input",{type:"number",id:"totalSeats",name:"totalSeats",value:i.totalSeats,onChange:handleChange,className:"input-field",min:"1",required:!0,placeholder:"Number of seats"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"ticketPrice",className:"form-label",children:"Ticket Price *"}),a.jsx("input",{type:"number",id:"ticketPrice",name:"ticketPrice",value:i.ticketPrice,onChange:handleChange,className:"input-field",min:"0",step:"0.01",required:!0,placeholder:"Price per ticket"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"form-label",children:"Primary Image *"}),(0,a.jsxs)("div",{className:"mt-1",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(t){d(t);let e=new FileReader;e.onload=e=>{u(e.target?.result)},e.readAsDataURL(t)}},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),x&&a.jsx("div",{className:"mt-2",children:a.jsx("img",{src:x,alt:"Primary preview",className:"h-32 w-48 object-cover rounded-lg"})})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"form-label",children:"Secondary Images (Optional)"}),(0,a.jsxs)("div",{className:"mt-1",children:[a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=Array.from(e.target.files||[]);m(t);let s=[];t.forEach(e=>{let a=new FileReader;a.onload=e=>{s.push(e.target?.result),s.length===t.length&&p(s)},a.readAsDataURL(e)})},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),h.length>0&&a.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:h.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[a.jsx("img",{src:e,alt:`Secondary ${t+1}`,className:"h-20 w-full object-cover rounded-lg"}),a.jsx("button",{type:"button",onClick:()=>removeSecondaryImage(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm hover:bg-red-600",children:"\xd7"})]},t))})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:t,className:"btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:g,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Saving...":e?"Update Event":"Create Event"})]})]})]})})}function AdminEventsPage(){let[e,t]=(0,r.useState)(null),[s,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)([]),[m,x]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[p,g]=(0,r.useState)(1),[v,f]=(0,r.useState)(1),[y,j]=(0,r.useState)(!1),b=(0,i.useRouter)();(0,r.useEffect)(()=>{let checkAuth=async()=>{let e=(0,l.bW)();if(!e){b.push("/");return}try{let e=await l.kv.getCurrentUser();if("admin"!==e.user.role){(0,l.H6)(),b.push("/");return}t(e.user)}catch(e){(0,l.H6)(),b.push("/")}finally{o(!1)}};checkAuth()},[b]),(0,r.useEffect)(()=>{e&&loadEvents()},[e,p]);let loadEvents=async()=>{j(!0);try{let e=await n.d.getEvents(p,10,"all");c(e.events),f(e.totalPages)}catch(e){console.error("Error loading events:",e)}finally{j(!1)}},handleFormSubmit=async()=>{x(!1),h(null),await loadEvents()},handleDeleteEvent=async e=>{if(window.confirm("Are you sure you want to delete this event?"))try{await n.d.deleteEvent(e),await loadEvents()}catch(e){console.error("Error deleting event:",e),alert("Failed to delete event")}},handleStatusChange=async(e,t)=>{try{await n.d.updateEventStatus(e,t),await loadEvents()}catch(e){console.error("Error updating event status:",e),alert("Failed to update event status")}};return s?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[a.jsx("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Event Management"}),a.jsx("p",{className:"text-gray-600",children:"Manage your events"})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>{h(null),x(!0)},className:"btn-primary",children:"+ Create Event"}),a.jsx("button",{onClick:()=>{(0,l.H6)(),b.push("/")},className:"btn-secondary",children:"Logout"})]})]})})}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:m?a.jsx(EventForm,{event:u,onClose:()=>{x(!1),h(null)},onSubmit:handleFormSubmit}):a.jsx(EventList,{events:d,loading:y,onEdit:e=>{h(e),x(!0)},onDelete:handleDeleteEvent,onStatusChange:handleStatusChange,currentPage:p,totalPages:v,onPageChange:g})})]})}},1945:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var a=s(7536);let r=(0,a.createProxy)(String.raw`C:\Users\missa\Downloads\kretoss technology\frontend\app\admin\events\page.tsx`),{__esModule:i,$$typeof:l}=r,n=r.default,o=n}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[416,503,58],()=>__webpack_exec__(1212));module.exports=s})();